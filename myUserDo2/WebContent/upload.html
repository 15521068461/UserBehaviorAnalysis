<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>ajax文件上传测试</title>
<link rel="icon" href="favicon.ico" type="image/ico">
<meta name="keywords" content="LightYear,光年,后台模板,后台管理系统,光年HTML模板">
<meta name="description" content="LightYear是一个基于Bootstrap v3.3.7的后台管理系统的HTML模板。">
<meta name="author" content="yinqi">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/materialdesignicons.min.css" rel="stylesheet">
<link href="css/style.min.css" rel="stylesheet">
</head>
<body>

<form enctype="multipart/form-data">
           <p>头像：<input type="file" id="avator" /></p>
           <p><input type="submit" id="submit" value="提交" onclick="up()"/></p>
       </form>


<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript">
  
    function up(){
            $("form").submit(function () {
                var avator = $('#avator').get(0).files[0]; //获取上传的文件;//get(0)将Jquery对象转换为DOM对象
                var formData = new FormData();  //创建一个forData
                formData.append('avator', avator);
                $.ajax({
                    url: 'http://127.0.0.1:9998/myUserDo/open/common/upload',
					headers: {
					        token:sessionStorage.getItem("token")
					    },
                    method: 'post',
					crossDomain: true,
					xhrFields:{
						withCredentials:true
					},
                    data: formData,
                    dataType: 'json',
                    processData: false,//数据处理
                    contentType: false,//内容类型
                    cache: false,
                    async: true,
                   success: function(resp){
                   	
                 alert("成功");
                   },
                 error: function(jqXHR, textStatus, errorThrown)
                 {
                 	alert("错误:");
                 }
                })
            });
        }
		
		
</script>
</body>
</html>